<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="程序媛">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        TAMU CTF Re - undefined
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> 一天一点进步 </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar ">
            <img src="/img/avatar.jpg" />
        </div>
        <div class="name">
            <i>Snow146</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>HOME</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>TAGS</span>
                </a>
            </li>
            <li >
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>ARCHIVES</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>ABOUT</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>SEARCH</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Cheesy"><span class="toc-text">Cheesy</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Snakes-over-cheese"><span class="toc-text">Snakes over cheese</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#042"><span class="toc-text">042</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#keygenme"><span class="toc-text">keygenme</span></a></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">search</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> 一天一点进步 </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        TAMU CTF Re
    </div>

    <div class="post-meta">
        <span class="attr">Post：<span>2019-03-05 00:00:00</span></span>
        
        <span class="attr">Tags：/
        
        <a class="tag" href="/tags/#CTF" title="CTF">CTF</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">Visit：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content ">
        <p>TAMU CTF 逆向有简单也有复杂的，前天刚结束，今天把这个总结一下。<br>附上题目，提取码rb8r<a href="https://pan.baidu.com/s/1A5G-pRd3oYkzVYVJDVIxvQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1A5G-pRd3oYkzVYVJDVIxvQ</a></p>
<h1 id="Cheesy"><a href="#Cheesy" class="headerlink" title="Cheesy"></a>Cheesy</h1><p>文件放到Ubuntu中运行一遍，发现采用了base64编码，把给出的加密代码解密，并没有发现flag，并且解密之后告诉你你已经错过了flag，所以考虑，是否还有未解密的隐藏代码，放到ida中发现了<br><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Z<span class="number">2</span>l<span class="symbol">nZW17</span><span class="name">M2</span>E<span class="number">1</span>eV<span class="number">9</span>S<span class="name">M3</span>YzcjUxTjYhfQ==</span><br></pre></td></tr></table></figure></p>
<p>这一串密码未输出，经过解密就是flag<br><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gigem&#123;3a5y_R3v3r51N6!&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="Snakes-over-cheese"><a href="#Snakes-over-cheese" class="headerlink" title="Snakes over cheese"></a>Snakes over cheese</h1><p>给的是一个.pyc文件，用uncompyle反编译一下得到.py文件，使用命令<br><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">u<span class="symbol">ncompyle6</span> reversi<span class="symbol">ng2</span>.pyc &gt; reversi<span class="symbol">ng2</span>.py</span><br></pre></td></tr></table></figure></p>
<p>的得到如下的py文件，运行一下发现需要输入正确的密码才能给你flag<br>不用那么麻烦的把密码给逆向出来，直接修改一下py文件直接得出flag<img src="https://i.imgur.com/lTqDFRF.png" alt=""><br>运行结果如下：</p>
<p><img src="https://i.imgur.com/VYM1dQk.png" alt=""></p>
<h1 id="042"><a href="#042" class="headerlink" title="042"></a>042</h1><p>这是一道真正的反汇编，给的文件不能编译所以要纯看汇编代码，但是这个汇编代码还是很简单的，前面第一个function是一个迷惑代码，实质上没用，主要看main函数，关键代码在如下地方<img src="https://i.imgur.com/jvvwX2N.png" alt=""><br>在第二printf函数后面放入的是栈中[rbp-16]的地址，即从[rbp-16]向下取值回到上面就能看到存入栈中的值，即可获得flag<br><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">gigem</span><span class="template-variable">&#123;A553Mb1Y&#125;</span><span class="xml"></span></span><br></pre></td></tr></table></figure></p>
<h1 id="keygenme"><a href="#keygenme" class="headerlink" title="keygenme"></a>keygenme</h1><p>把enc()这个函数逆向就完了，但是有一个需要注意的地方，这里输入的a1在运行过程中strlen()函数包含了输入时的回车符’\n’所以根据得到v5知道a1的长度应该是17，但是包含了最后的回车符，所以a1只有16个，脚本如下<img src="https://i.imgur.com/ffqFf4X.png" alt=""><br>提交就能得到flag，比赛的时候一直没有想到这个问题，知道是多了个’Enter’但是实在没想到是这样，比赛结束后用C语言正着证明了一遍<br><img src="https://i.imgur.com/ckwb2Z8.png" alt=""><br><img src="https://i.imgur.com/Al0tO39.png" alt=""></p>
<p>#NoCCBytes#<br>放到ida里面re了一下发现答案在globPass中，显然DATA中的字符串肯定不是，但是我们可以动态调试啊，但是文件开了保护机制，所以下断点的时候要绕开这些保护机制，所以直接一点直接把断点下在字符串比较的地方。然后就看到内存中的golbpass<br><img src="https://i.imgur.com/XWUxGlE.png" alt=""><br>满眼答案…提交就能得到flag</p>

        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        <li>
            <a target="_blank" href="https://twitter.com/SnowYa5">
                            <span class="fa-stack fa-lg">
                                <i class="iconfont icon-twitter"></i>
                            </span>
            </a>
        </li>
        
        

        
        <li>
            <a target="_blank" href="http://weibo.com/2880425030">
                            <span class="fa-stack fa-lg">
                                  <i class="iconfont icon-weibo"></i>
                            </span>
            </a>
        </li>
        

        
        <li>
            <a target="_blank" href="https://www.facebook.com/layla.young.5454">
                            <span class="fa-stack fa-lg">
                                <i class="iconfont icon-facebook"></i>
                            </span>
            </a>
        </li>
        

        
        <li>
            <a target="_blank"  href="https://github.com/snow146">
                            <span class="fa-stack fa-lg">
                                <i class="iconfont icon-github"></i>
                            </span>
            </a>
        </li>
        

        

    </ul>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a href="https://hexo.io/">Hexo</a>  Theme <a href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




</html>
